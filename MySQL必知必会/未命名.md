## 视图

### 1. 视图的规则和限制

* 和表一样，试图必须唯一命名。
* 对于可以创建的试图数目没有限制。
* 为了创建试图，必须具有足够的访问权限。
* 试图可以嵌套，即可以利用从其他视图中检索数据的查询来构造一个视图。
* ORDER BY 可以用在视图中，但如果从该视图检索数据SELECT中也包含ORDER BY， 那么该视图中的ORDER BY将被覆盖。
* 视图不能索引，也不能有关联的触发器或默认值。
* 视图可以和表一起使用。

### 2. 使用视图

* 视图创建：`CREATE VIEW` 

  ```sql
  CREATE VIEW customeremaillist AS
      SELECT cust_id, cust_name, cust_email
  FROM customers
  WHERE cust_email IS NOT NULL;
  ```

* 查看创建视图的语句：`SHOW CREATE VIEW viewname`

* 用`DROP`删除视图，语法为 `DROP VIEW viewname`

* 更新视图时，可以先使用`DROP`再使用`CREATE`。

  也可以直接用`CREATE OR REPLACE VIEW`:

  * 如果要更新的视图不存在，则第二条语句会创建一个视图；
  * 如果要更新的视图存在，则第2条更新语句会替代原有视图。

> 如果从视图检索数据时使用了一条WHERE子句，则两组子句（一组在视图中，另一组时传递给视图的）将自动组合。

### 3.视图更新

略

## 存储过程

### 1. 使用存储过程的理由

* 通过把处理封装在容易使用的单元中，简化复杂的操作。
* 由于不要求反复建立一系列处理步骤，这保证了数据的完整性。
* 简化对变动的管理。
* 提高性能：使用存储过程比使用单独的SQL语句要快。

### 2. 使用存储过程

MySQL执行存储过程的语句为`CALL`。

`CALL`接受**存储过程的名字**以及需要传递给它的任意**参数**。

例如

```sql
CALL producpricing(@pricelow
                   @pricehigh
                   @priceaverage);
```

其中，执行名为`productpricing`的存储过程，它计算并返回产品的最低、最高和平均价格。

